# ジェスチャーウルフ - 仕様書

## 1. プロジェクト概要

### 1.1 アプリケーション名
ジェスチャーウルフ (Gesture Wolf)

### 1.2 概要
ワードウルフのジェスチャー版パーティーゲームアプリ。プレイヤーにお題を配布し、ジェスチャーで表現し合い、少数派（ウルフ）を当てるゲーム。

### 1.3 対象プラットフォーム
- Android
- iOS
- オフライン動作必須

---

## 2. ゲームルール

### 2.1 基本ルール
- **プレイヤー数**: 3〜8人
- **役割**: 多数派（市民）と少数派（ウルフ）
- **お題**: 2つの似ているが異なるお題を配布
- **ゲームフロー**:
  1. お題配布（他プレイヤーに見られないように）
  2. ジェスチャータイム（各15-20秒）
  3. ディスカッション（2-3分）
  4. 投票
  5. 結果発表

### 2.2 ウルフ人数
| プレイヤー数 | ウルフ数 |
|------------|---------|
| 3-4人      | 1人     |
| 5-6人      | 1人     |
| 7-8人      | 1-2人   |

### 2.3 勝利条件
- **市民勝利**: ウルフを正しく当てる
- **ウルフ勝利**: ウルフが当てられない

---

## 3. 画面設計

### 3.1 ホーム画面
**目的**: アプリのエントリーポイント

**UI要素**:
- アプリタイトル
- ゲーム開始ボタン（大きく目立つ）
- ルール説明ボタン
- 設定ボタン

**遷移**:
- ゲーム開始 → プレイヤー設定画面
- ルール説明 → ルール説明ダイアログ/画面
- 設定 → 設定画面

---

### 3.2 プレイヤー設定画面
**目的**: ゲーム参加者の設定

**UI要素**:
- プレイヤー人数選択（3〜8人）
  - スライダーまたはボタン選択
- プレイヤー名入力リスト
  - デフォルト: プレイヤー1, プレイヤー2...
  - 編集可能なテキストフィールド
- ウルフ人数表示（自動計算、表示のみ）
- 次へボタン

**バリデーション**:
- プレイヤー数: 3-8人
- プレイヤー名: 空欄可（デフォルト使用）

**遷移**:
- 次へ → お題選択画面
- 戻る → ホーム画面

---

### 3.3 お題選択画面
**目的**: ゲームのお題を選択

**UI要素**:
- カテゴリー選択
  - 動物
  - スポーツ
  - 職業
  - 動作
  - その他
- 各カテゴリーのお題ペアリスト（スクロール可能）
- ランダム選択ボタン
- カスタムお題入力セクション
  - 市民のお題入力
  - ウルフのお題入力
- ゲーム開始ボタン

**データ例**:
```dart
{
  "動物": [
    {"majority": "犬", "minority": "猫"},
    {"majority": "ライオン", "minority": "トラ"}
  ],
  "スポーツ": [
    {"majority": "野球", "minority": "テニス"},
    {"majority": "サッカー", "minority": "バスケ"}
  ],
  "職業": [
    {"majority": "料理人", "minority": "パティシエ"},
    {"majority": "医者", "minority": "看護師"}
  ],
  "動作": [
    {"majority": "泳ぐ", "minority": "溺れる"},
    {"majority": "走る", "minority": "逃げる"}
  ]
}
```

**遷移**:
- ゲーム開始 → お題配布画面
- 戻る → プレイヤー設定画面

---

### 3.4 お題配布画面
**目的**: 各プレイヤーに個別にお題を見せる

**UI要素**:
- 現在のプレイヤー表示
  - 「プレイヤー〇〇さん、準備はいいですか？」
- お題を見るボタン（大きく）
- お題表示エリア（初期非表示）
  - タップ後に表示
  - 大きく見やすい文字
- 確認しましたボタン
- 進行状況インジケーター（〇/〇人）

**フロー**:
1. プレイヤー名表示
2. お題を見るボタンタップ
3. お題表示（他の人に見られないよう注意喚起）
4. 確認しましたボタンタップ
5. 次のプレイヤーへ（またはジェスチャータイムへ）

**セキュリティ**:
- お題表示時は画面を覆うオーバーレイ
- 他の人が見ていないか確認する注意書き

**遷移**:
- 全員確認後 → ジェスチャータイム画面

---

### 3.5 ジェスチャータイム画面
**目的**: 各プレイヤーがジェスチャーを披露

**UI要素**:
- 現在のプレイヤー名表示
- カウントダウンタイマー（15-20秒、設定可能）
  - 大きく見やすい表示
  - 残り5秒で色変化などの視覚効果
- 次のプレイヤーボタン
- 進行状況（〇/〇人）
- スキップボタン（オプション）
- 2周目実施チェックボックス（全員終了後）

**フロー**:
1. プレイヤー名表示
2. タイマースタート
3. タイマー終了または次のプレイヤーボタン
4. 次のプレイヤーへ
5. 全員終了後、2周目の選択肢表示
6. ディスカッションへ進むボタン表示

**遷移**:
- 全員終了 → ディスカッション画面

---

### 3.6 ディスカッション画面
**目的**: プレイヤー間の議論時間

**UI要素**:
- タイマー（2-3分、設定可能）
  - 大きく見やすい表示
- ルール再確認
  - 「ジェスチャー追加はNG」など
- プレイヤーリスト（参考用）
- 投票へ進むボタン
- タイマー延長ボタン（オプション）

**遷移**:
- 投票へ進む → 投票画面

---

### 3.7 投票画面
**目的**: ウルフの投票

**UI要素**:
- 「誰がウルフだと思いますか？」表示
- 全プレイヤーのボタン（グリッドまたはリスト）
- 投票確定ボタン
- 投票状況（〇/〇人投票済み）
- やり直しボタン

**フロー**:
1. 各プレイヤーが順番に投票
2. プレイヤー選択
3. 確定
4. 次のプレイヤーへ
5. 全員投票後、集計結果表示
6. 最多票のプレイヤー表示

**遷移**:
- 全員投票完了 → 結果画面

---

### 3.8 結果画面
**目的**: ゲーム結果の発表

**UI要素**:
- 勝利チーム表示（市民 or ウルフ）
  - 大きく目立つアニメーション
- ウルフ発表
  - プレイヤー名表示
- 全プレイヤーのお題公開
  - リスト形式
  - 市民/ウルフの区別
- 投票結果サマリー
- もう一度遊ぶボタン
- ホームに戻るボタン

**遷移**:
- もう一度遊ぶ → プレイヤー設定画面（前回の設定を保持）
- ホームに戻る → ホーム画面

---

### 3.9 設定画面
**目的**: ゲーム設定のカスタマイズ

**UI要素**:
- ジェスチャー時間設定（10-30秒）
- ディスカッション時間設定（1-5分）
- 効果音ON/OFF
- BGM ON/OFF
- ダークモードON/OFF
- 言語選択（日本語/英語）

---

### 3.10 ルール説明画面
**目的**: ゲームルールの説明

**UI要素**:
- ゲーム概要
- 基本ルール
- 遊び方の流れ
- 勝利条件
- 閉じるボタン

---

## 4. データ構造

### 4.1 ゲーム状態
```dart
enum GamePhase {
  home,
  playerSetup,
  themeSelection,
  themeDistribution,
  gesture,
  discussion,
  voting,
  result,
}

class GameState {
  GamePhase currentPhase;
  int playerCount;
  List<Player> players;
  ThemePair selectedTheme;
  int currentPlayerIndex;
  int gestureRound; // 1 or 2
  Map<String, int> votes; // playerId -> votedForPlayerId
  GameSettings settings;
}
```

### 4.2 プレイヤー
```dart
class Player {
  String id;
  String name;
  String theme;
  bool isWolf;
  int? votedForIndex;
}
```

### 4.3 お題
```dart
class ThemePair {
  String category;
  String majorityTheme;
  String minorityTheme;
}

class ThemeData {
  String category;
  List<ThemePair> themes;
}
```

### 4.4 設定
```dart
class GameSettings {
  int gestureDuration; // seconds
  int discussionDuration; // seconds
  bool soundEnabled;
  bool musicEnabled;
  bool darkMode;
  String language; // 'ja' or 'en'
}
```

---

## 5. 技術要件

### 5.1 技術スタック
- **フレームワーク**: Flutter 3.x以上
- **状態管理**: Riverpod または Provider
- **ローカルストレージ**: shared_preferences
- **ナビゲーション**: go_router または Navigator 2.0

### 5.2 依存パッケージ
```yaml
dependencies:
  flutter:
    sdk: flutter
  flutter_riverpod: ^2.4.0 # または provider
  go_router: ^12.0.0
  shared_preferences: ^2.2.0
  google_fonts: ^6.0.0
  flutter_animate: ^4.0.0 # アニメーション用
  
dev_dependencies:
  flutter_test:
    sdk: flutter
  flutter_lints: ^3.0.0
```

### 5.3 設計方針
- **状態管理**: 
  - GameStateを中心としたグローバル状態管理
  - 各画面は状態を読み取り、アクションを発行
- **UI/UX**:
  - Material Design 3準拠
  - レスポンシブデザイン
  - 視認性の高い配色
  - タップしやすいボタンサイズ（最小44x44pt）
- **アクセシビリティ**:
  - 十分なコントラスト比
  - 大きく読みやすいフォント
  - セマンティクス対応

---

## 6. お題データ

### 6.1 最低要件
- 各カテゴリーに最低5組以上
- 合計20組以上のお題ペア

### 6.2 お題データファイル構造
```dart
// lib/data/themes.dart
final List<ThemeData> themeDatabase = [
  ThemeData(
    category: '動物',
    themes: [
      ThemePair(category: '動物', majorityTheme: '犬', minorityTheme: '猫'),
      ThemePair(category: '動物', majorityTheme: 'ライオン', minorityTheme: 'トラ'),
      // ... more themes
    ],
  ),
  // ... more categories
];
```

---

## 7. 追加機能（オプション）

### 7.1 優先度：高
- [ ] 効果音・BGM
- [ ] プレイ履歴の保存
- [ ] お気に入りお題リスト

### 7.2 優先度：中
- [ ] カスタムお題の保存機能
- [ ] 多言語対応（日本語・英語）
- [ ] チュートリアルモード

### 7.3 優先度：低
- [ ] オンライン対戦モード
- [ ] 統計情報（勝率など）
- [ ] アチーブメントシステム

---

## 8. 成果物

### 8.1 必須成果物
- [ ] 動作するFlutterアプリのソースコード
- [ ] pubspec.yamlの依存関係設定
- [ ] お題データファイル
- [ ] README.md（セットアップ手順、ビルド方法）

### 8.2 推奨成果物
- [ ] SPECIFICATION.md（本ドキュメント）
- [ ] API/データ構造ドキュメント
- [ ] UI/UXデザインガイド

---

## 9. 開発フェーズ

### Phase 1: 基本実装
- [ ] プロジェクトセットアップ
- [ ] データ構造定義
- [ ] 状態管理セットアップ
- [ ] ホーム画面
- [ ] プレイヤー設定画面
- [ ] お題選択画面（プリセットのみ）

### Phase 2: コアゲームフロー
- [ ] お題配布画面
- [ ] ジェスチャータイム画面
- [ ] ディスカッション画面
- [ ] 投票画面
- [ ] 結果画面

### Phase 3: 追加機能
- [ ] 設定画面
- [ ] ルール説明画面
- [ ] カスタムお題機能
- [ ] データ永続化

### Phase 4: 仕上げ
- [ ] UI/UXの洗練
- [ ] アニメーション追加
- [ ] 効果音・BGM
- [ ] テスト
- [ ] バグフィックス

---

## 10. 制約事項

### 10.1 技術制約
- オフラインで完全動作
- Android/iOS両対応
- メモリ使用量の最適化

### 10.2 デザイン制約
- シンプルで直感的なUI
- パーティーゲームらしい楽しい雰囲気
- 暗い場所でも見やすい配色

---

## 11. テスト方針

### 11.1 単体テスト
- ゲームロジックのテスト
- 状態管理のテスト
- ウルフ選定ロジックのテスト

### 11.2 統合テスト
- 画面遷移のテスト
- ゲームフロー全体のテスト

### 11.3 手動テスト
- 実機でのユーザビリティテスト
- 複数人でのプレイテスト

---

## 12. リリース準備

### 12.1 Android
- [ ] アプリアイコン
- [ ] スプラッシュスクリーン
- [ ] build.gradle設定
- [ ] 署名設定

### 12.2 iOS
- [ ] アプリアイコン
- [ ] スプラッシュスクリーン
- [ ] Info.plist設定
- [ ] プロビジョニング

---

## 変更履歴

| 日付 | バージョン | 変更内容 | 担当者 |
|------|-----------|---------|-------|
| 2025-12-06 | 1.0.0 | 初版作成 | - |
